<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Borang Penerimaaan Buku Teks - SMK Menengah Kebangsaan Tasek Gelugor</title>
    <script type="text/javascript" src="https://gc.kis.v2.scr.kaspersky-labs.com/FD126C42-EBFA-4E12-B309-BB3FDD723AC1/main.js?attr=jtuWUba58fpxd5VCaPoupAPpR5XKlmGoZUry9fiDH_sEA4-j_3Uue9FlzuEFcGViNq55eMq1f-8nFsj49OuT-d4YfenkQhbsigfQa5HNPqDeVjQE7Kf6t_-UUVPAuBlFVhgTUzhha5XWKYvbRf3Lu76LmTvNNH6gUDksDaDL5sGuBzxNFEPcew3HzlzfOH05tBiDlh3Qz2NU0fzvPp2RI1q8qsL0XCJ50qjdMuM4qoxD1KirtUPyh_TXKJStd6AG-XdEMB73Raxiiy-xt5RuN0yWTbdP8tG7eiEfsuhZk6WVecAMm8j9Z2y0LcvBe1nkJEcEkl-RTYqtMPWPSwGCj8as5DfmhK3DWTSax5uNSs_Azv53bjbv_wHla8BzFKuMbHDJlG2E0bx8Lfs6fFRCuSP58tY8RTf0KuYskVNuSHQg1JZffOqPSN8Bus1XGkkJhUgB3E7pc2hbb2IV6UKer6SKOMe6MtFQHKKV5JPgsgNCrDc_YyD3Iv3RiYIGEiSGkN8fPr1Jk8eCb8L9boSWEc74A32rAa-ecbiyZYfUg8Pfgk0XtSWke_bFCh7jRJl7g-pBYkVIw7XJegF08UKGahe062Cq3NzHoDboWR2UBp-9fPVrJFxb2Tk8FGtJjvs1YU6MLncdfwDrkt-_nzzsraaL2DYN_AoCM9wI1qCJ5nwI7QXN6mjfNkW1_yyLlyNgNPoX9XoB_MQX6Vy7TqwHbRY9aB_CQGeKFG9TlYFLgao_hiGEfqyp6OgyDCfQ2YOoMu83cYQEPES2YZH06KUAPFIGPqPDF2dT3OR5HT7Bye8HXf0NNNkcb4xt0vZAbCMWSWJY02E3PSGoIGTvQOq1fjggNvBbxh2cbX8-hnnvacksC-24XSJEndoqYk7VKYse7wbPoQaTlqBRx56MjO1Hjv1NpErEXGTbnWXAnGn9Owh6uVbHCVDe4oaErVred4aD26zpGgBT7wOaIE2SQKbAi5BqEJgX1GxDKsjK-1T3vkgT7sTUTqSTh9ABosMKpZkH4ajuKFYVBbutmn7XnBHXI7gJ_sitl14ymKAEc_XNnAVYP_HvHqbRQ4MF0_9ULFxxGf4Sh1tFdsvHBN-I-e_pnSX9W4YwsdZMMomaOgX9pD8JMFXo0IDFKjZSKDkXCq_5CuidAzbPROxa54AFmhvhsQMFsGSRStUh2Vk8JqtzijwIjs5oAC8M5isQmk_FGm4_Mu4gO7fudlGWeDYioGVNYIAgGlOEQIU9bQJJoDzEt7QTTDADhJaycujdFpOEEKOK1R_Jjn3vcVnwuYAeO0poEkKO2QKKkPJ3aO92PRVBUvux6LGYgq3EtbXbCMSUTfG2EBCRdYBvyQ8HF6J6vR5pQpo9REufAaSjeoUG9htTbIUHqtQrCvGQ6tNU7VRrmg0K-OcCAl2vY3hAxPtneURyexBbQqg3Te2RvUmfxeEX3nuSFZDEoPk3ly47FxwuPv_wnVPx5E0HITMn77r1M5BH0Hl6FjWbf7xOLINz4-4s57P8ty9zAA-1kM8M9BePEOojlB6mo7HRPQ_F4gAgKUpJ5Kyb964ByAhvEEqwvQa_5qZ8pnHlWp9PQeoGqP9kXXi1f7ZaZTrV6Vw0eOopd2YV-cUCAa9yYps378qZoQmjzdyYHf93WzitG4QqOft-QoF6_G83fuNkYJLny9Fow4J0UL4svJ2umYeZI6hhjS6WSpls7S0HVV5wZqSrsAH95Eh7OHExnVAscpRtz-ivVwG37wUO5Bky_FSYvsHTuu4nefaXkMlSZX2l-gDl7uD_7hRkI35_roiBCsdlPO4WNbg1f0S3GUTD4qAKvmJok2q3DTw6SiCE_-WwH2byQo670hU-_jgmaXfKu_131BGTLT_NSdvL9Pq9m4IQ3bXMeRD_EmYBKP8U7efYjaxmnE5-daO2sKiyg75LI6yK51Ga7dXkWXsM2N8wK9GKUG9NBQYYO1aCelUFNJtc6oB7d2oUnqArrMhMt6gSLyPYZ9nB3LOZA9PcN65VHlUAI17PobuSZ5Rs3GEiFUs9DJhX6ODpsw0boWm4jHa2PbDZ2Y8Ky0uyKiSRuHQJWcOUGQtHrzCB6jJ2hlTWcuVMh_fIj2lcPu97ploDUr9X20u8Li_u5qk_AWY0ZG1LYg4N-wEPpYkVd_1LCz3tBAONPBAr5c1Bgzim12Kb-3gPevt3vmI9MCbkoqVAc-_vYCzJhvNPgucq5OPo5OamZRXhF9WkucLF5bhm" charset="UTF-8"></script><style>
        :root {
            --color-primary: #1a6b7f;
            --color-secondary: #e8f4f8;
            --color-text: #1f2121;
            --color-border: #bbb;
            --color-bg: #fafaf9;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background-color: var(--color-bg);
            color: var(--color-text);
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        .form-section {
            background: white;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .form-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--color-primary);
            padding-bottom: 20px;
        }

        .school-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 15px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 24px;
            border: 3px solid var(--color-primary);
        }

        .form-header h1 {
            font-size: 20px;
            color: var(--color-primary);
            margin-bottom: 5px;
        }

        .form-header p {
            font-size: 14px;
            color: #666;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row.full {
            grid-template-columns: 1fr;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
            color: var(--color-text);
        }

        input[type="text"],
        input[type="date"],
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--color-border);
            border-radius: 4px;
            font-size: 14px;
            font-family: inherit;
        }

        input[type="text"]:focus,
        input[type="date"]:focus,
        select:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(26, 107, 127, 0.1);
        }

        .books-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .books-table th {
            background-color: var(--color-primary);
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
        }

        .books-table td {
            padding: 12px;
            border-bottom: 1px solid #ddd;
            font-size: 13px;
        }

        .books-table tr:hover {
            background-color: var(--color-secondary);
        }

        .books-table input[type="checkbox"] {
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .button-group {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 30px;
        }

        button {
            padding: 12px 30px;
            font-size: 14px;
            font-weight: 600;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background-color: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: #135a6a;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(26, 107, 127, 0.3);
        }

        .btn-secondary {
            background-color: #f0f0f0;
            color: var(--color-text);
            border: 1px solid var(--color-border);
        }

        .btn-secondary:hover {
            background-color: #e0e0e0;
        }

        .btn-print {
            background-color: #2ecc71;
            color: white;
        }

        .btn-print:hover {
            background-color: #27ae60;
        }

        .print-preview {
            display: none;
            background: white;
            padding: 40px;
            border: 1px solid var(--color-border);
            margin-top: 30px;
            page-break-after: always;
        }

        .print-preview.active {
            display: block;
        }

        .preview-header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--color-primary);
            padding-bottom: 15px;
        }

        .preview-header h2 {
            font-size: 16px;
            color: var(--color-primary);
            margin-bottom: 5px;
        }

        .preview-header p {
            font-size: 12px;
            color: #666;
        }

        .preview-content {
            font-size: 13px;
            line-height: 1.6;
        }

        .preview-content strong {
            color: var(--color-primary);
        }

        .preview-table {
            width: 100%;
            margin: 20px 0;
            border-collapse: collapse;
            font-size: 12px;
        }

        .preview-table th,
        .preview-table td {
            border: 1px solid var(--color-border);
            padding: 10px;
            text-align: left;
        }

        .preview-table th {
            background-color: var(--color-secondary);
            font-weight: 600;
            color: var(--color-primary);
        }

        .preview-footer {
            margin-top: 40px;
            text-align: center;
            font-size: 12px;
        }

        .tick-mark {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: var(--color-primary);
        }

        .section-title {
            background-color: var(--color-secondary);
            padding: 12px;
            margin: 20px 0 15px 0;
            border-left: 4px solid var(--color-primary);
            font-weight: 600;
            color: var(--color-primary);
            font-size: 14px;
        }

        .hidden {
            display: none;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .form-section {
                box-shadow: none;
                margin-bottom: 0;
                padding: 0;
            }

            .button-group {
                display: none;
            }

            .print-preview {
                display: block !important;
                margin-top: 0;
            }
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- FORM INPUT -->
        <div class="form-section">
            <div class="form-header">
                <div class="school-logo">
                    <img src="https://agi-prod-file-upload-public-main-use1.s3.amazonaws.com/be5a4edd-d4de-4047-bcac-dfee5ca3e43d" alt="Logo SABK" style="width: 100%; height: 100%; object-fit: contain;">
                </div>
                <h1>BORANG AKUAN PENERIMAAAN BUKU TEKS</h1>
                <p>Skim Pinjaman Buku Teks - SABK Al-Madrasah Al-Khairiah Al-Islamiah</p>
            </div>

            <form id="textbookForm">
                <!-- Student Information -->
                <div class="section-title">MAKLUMAT PELAJAR</div>

                <div class="form-row full">
                    <div class="form-group">
                        <label for="studentName">Nama Pelajar:</label>
                        <input type="text" id="studentName" name="studentName" required>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="form">Tingkatan:</label>
                        <select id="form" name="form" required onchange="updateBooksList(); updateClassesList();">
                            <option value="">-- Pilih Tingkatan --</option>
                            <option value="1">Tingkatan 1</option>
                            <option value="2">Tingkatan 2</option>
                            <option value="3">Tingkatan 3</option>
                            <option value="4">Tingkatan 4</option>
                            <option value="5">Tingkatan 5</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="className">Kelas:</label>
                        <select id="className" name="className" required onchange="updateClassesList()">
                            <option value="">-- Pilih Kelas --</option>
                        </select>
                    </div>
                </div>

                <div class="form-row full">
                    <div class="form-group">
                        <label for="parentName">Nama Ibu Bapa/Penjaga:</label>
                        <input type="text" id="parentName" name="parentName">
                    </div>
                </div>

                <!-- Books List -->
                <div class="section-title">SENARAI BUKU TEKS YANG DITERIMA</div>

                <table class="books-table" id="booksTable">
                    <thead>
                        <tr>
                            <th style="width: 5%;">Bil</th>
                            <th style="width: 60%;">Judul Buku</th>
                            <th style="width: 15%;">Terima Buku ✓</th>
                            <th style="width: 20%;">Catatan</th>
                        </tr>
                    </thead>
                    <tbody id="booksTableBody">
                        <!-- Books will be dynamically inserted here -->
                    </tbody>
                </table>

                <!-- Action Buttons -->
                <div class="button-group">
                    <button type="button" class="btn-secondary" onclick="resetForm()">Padam</button>
                    <button type="button" class="btn-primary" onclick="generatePreview()">Semak & Cetak</button>
                </div>
            </form>
        </div>

        <!-- PRINT PREVIEW -->
        <div class="print-preview" id="printPreview">
            <div class="preview-header">
                <h2>BORANG AKUAN PENERIMAAAN BUKU TEKS</h2>
                <p>Skim Pinjaman Buku Teks - SABK Al-Madrasah Al-Khairiah Al-Islamiah</p>
            </div>

            <div class="preview-content">
                <p>Saya <strong id="previewStudentName">___________________</strong> dari kelas <strong id="previewClassName">___________________</strong> dengan ini mengakui telah menerima sejumlah <strong id="previewBookCount">___</strong> naskah buku teks SPBT seperti mana berikut:</p>

                <table class="preview-table">
                    <thead>
                        <tr>
                            <th style="width: 5%;">Bil</th>
                            <th style="width: 65%;">Judul Buku</th>
                            <th style="width: 15%;">Terima Buku</th>
                            <th style="width: 15%;">Catatan</th>
                        </tr>
                    </thead>
                    <tbody id="previewBooksTable">
                        <!-- Books will be dynamically inserted here -->
                    </tbody>
                </table>

                <p style="margin-top: 30px;"><strong>2.</strong> Saya memahami bahawa semua buku teks tersebut adalah Hak Kerajaan Malaysia yang dijanjikan kepada saya/anak/tanggungan saya tertakluk kepada peraturan Skim Pinjaman Buku Teks Sekolah.</p>

                <p style="margin-top: 15px;"><strong>3.</strong> Dengan ini saya berjanji akan menjaga buku teks dengan baik dan memenuhi peraturan SPBT seperti berikut:</p>

                <div style="margin-left: 20px; margin-top: 10px;">
                    <p><strong>3.1</strong> Membalut buku teks</p>
                    <p><strong>3.2</strong> Membawa buku teks ke sekolah</p>
                    <p><strong>3.3</strong> Tidak meninggalkan buku teks di merata-rata tempat</p>
                    <p><strong>3.4</strong> Tidak menconteng atau merosakan buku teks</p>
                    <p><strong>3.5</strong> Tidak menghilangkan buku teks</p>
                    <p><strong>3.6</strong> Memulangkan buku teks pada waktuya dengan jumlah yang mencukupi</p>
                </div>

                <p style="margin-top: 20px;"><strong>4.</strong> Kegagalan saya/anak/tanggungan saya mematuhi peraturan SPBT, pihak sekolah boleh mengambil tindakan yang sesuai terhadap saya/anak/tanggungan saya.</p>

                <div class="preview-footer">
                    <p style="margin-top: 40px; font-weight: bold;">Yang benar,</p>
                    <p style="margin-top: 60px;">_____________________</p>
                    <p style="font-size: 11px;">(<span id="previewParentName">Nama Ibu Bapa/Penjaga</span>)</p>
                    <p style="margin-top: 30px; font-size: 11px;" id="previewDate">Tarikh: _______________</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Database Senarai Kelas SABK
        const classesData = {
            '1': ['1 Hanafi', '1 Maliki', '1 Khaulah Al-Azwar', '1 Nusaibah Kaab'],
            '2': ['2 Hanafi', '2 Maliki', '2 Khaulah Al-Azwar', '2 Nusaibah Kaab'],
            '3': ['3 Hanafi', '3 Maliki', '3 Khaulah Al-Azwar', '3 Nusaibah Kaab'],
            '4': ['An-Nawawi', 'Rabiatul Adawiyah'],
            '5': ['An-Nawawi', 'Rabiatul Adawiyah']
        };

        // Database Buku Teks SABK Al-Madrasah Al-Khairiah Al-Islamiah
        const textbooksData = {
            '1': [
                'BAHASA MELAYU TINGKATAN 1',
                'BAHASA INGGERIS TINGKATAN 1 (PULSE 1)',
                'MATEMATIK TINGKATAN 1',
                'SAINS TINGKATAN 1',
                'GEOGRAFI TINGKATAN 1',
                'SEJARAH TINGKATAN 1',
                'PENDIDIKAN JASMANI DAN KESIHATAN TINGKATAN 1',
                'SENI VISUAL TINGKATAN 1',
                'REKA BENTUK DAN TEKNOLOGI TINGKATAN 1',
                'USULUDDIN TINGKATAN 1',
                'AL-SYARIAH TINGKATAN 1',
                'AL-LUGHAH AL-ARABIAH AL-MU\'ASIRAH TINGKATAN 1',
                'KUINGIN BERTERIMA KASIH',
                'PELARI MUDA',
                '20,000 LEAGUES UNDER THE SEA',
                'FAIR\'S FAIR',
                'POETRY FOR PLEASURE'
            ],
            '2': [
                'BAHASA MELAYU TINGKATAN 2',
                'BAHASA INGGERIS TINGKATAN 2 (PULSE 2)',
                'MATEMATIK TINGKATAN 2',
                'SAINS TINGKATAN 2',
                'GEOGRAFI TINGKATAN 2',
                'SEJARAH TINGKATAN 2',
                'PENDIDIKAN JASMANI DAN KESIHATAN TINGKATAN 2',
                'SENI VISUAL TINGKATAN 2',
                'REKA BENTUK DAN TEKNOLOGI TINGKATAN 2',
                'USULUDDIN TINGKATAN 2',
                'AL-SYARIAH TINGKATAN 2',
                'AL-LUGHAH AL-ARABIAH AL-MU\'ASIRAH TINGKATAN 2',
                'BAIK BUDI INDAH BAHASA',
                'JALAN KE PUNCAK',
                'ONE THOUSAND DOLLARS AND OTHER PLAYS',
                'SHORT STORY ARENA',
                'POETRY FOR PLEASURE'
            ],
            '3': [
                'BAHASA MELAYU TINGKATAN 3',
                'BAHASA INGGERIS TINGKATAN 3 (PULSE 3)',
                'MATEMATIK TINGKATAN 3',
                'SAINS TINGKATAN 3',
                'GEOGRAFI TINGKATAN 3',
                'SEJARAH TINGKATAN 3',
                'PENDIDIKAN JASMANI DAN KESIHATAN TINGKATAN 3',
                'SENI VISUAL TINGKATAN 3',
                'REKA BENTUK DAN TEKNOLOGI TINGKATAN 3',
                'USULUDDIN TINGKATAN 3',
                'AL-SYARIAH TINGKATAN 3',
                'AL-LUGHAH AL-ARABIAH AL-MU\'ASIRAH TINGKATAN 3',
                'BINTANG HATI',
                'JUSTERU IMPIAN DI JARING',
                'POETRY FOR PLEASURE',
                'WE DIDN\'T MEAN TO GO TO SEA'
            ],
            '4': [
                'BAHASA MELAYU TINGKATAN 4',
                'BAHASA INGGERIS TINGKATAN 4 (FULL BLAST PLUS 4)',
                'SEJARAH TINGKATAN 4',
                'MATEMATIK TINGKATAN 4',
                'SAINS TINGKATAN 4',
                'PERNIAGAAN TINGKATAN 4',
                'USULUDDIN TINGKATAN 4',
                'AL-SYARIAH TINGKATAN 4',
                'AL-LUGHAH AL-ARABIAH AL-MU\'ASIRAH TINGKATAN 4',
                'JAKET KULIT KIJANG DARI ISTANBUL',
                'JENDELA MENGHADAP JALAN',
                'CHANGING THEIR SKIES',
                'FIVE SHORT PLAYS',
                'LEAVING NO FOOTPRINT',
                'A POISON TREE',
                'THE LOST KING'
            ],
            '5': [
                'BAHASA MELAYU TINGKATAN 5',
                'BAHASA INGGERIS TINGKATAN 5',
                'SEJARAH TINGKATAN 5',
                'MATEMATIK TINGKATAN 5',
                'SAINS TINGKATAN 5',
                'PERNIAGAAN TINGKATAN 5',
                'USULUDDIN TINGKATAN 5',
                'AL-SYARIAH TINGKATAN 5',
                'AL-LUGHAH AL-ARABIAH AL-MU\'ASIRAH TINGKATAN 5',
                'SEJADAH RINDU',
                'SONGKET BERBENANG EMAS',
                'SING TO THE DAWN'
            ],
            'kbd': [
                'AL-SYARIAH KBD',
                'USULUDDIN KBD',
                'LAM (LITERASI ALQURAN & MAKNANYA) KBD',
                'BAHASA MELAYU KBD',
                'BAHASA INGGERIS KBD',
                'MATEMATIK KBD',
                'SAINS KBD',
                'SEJARAH KBD',
                'GEOGRAFI KBD',
                'PENDIDIKAN JASMANI DAN KESIHATAN KBD',
                'SENI VISUAL KBD',
                'MUZIK KBD',
                'REKA BENTUK DAN TEKNOLOGI KBD'
            ]
        };

        function updateClassesList() {
            const selectedForm = document.getElementById('form').value;
            const classes = classesData[selectedForm] || [];
            const classSelect = document.getElementById('className');

            classSelect.innerHTML = '<option value="">-- Pilih Kelas --</option>';

            classes.forEach((className) => {
                const option = document.createElement('option');
                option.value = className;
                option.textContent = className;
                classSelect.appendChild(option);
            });
        }

        function updateBooksList() {
            const selectedForm = document.getElementById('form').value;
            const books = textbooksData[selectedForm] || [];
            const tableBody = document.getElementById('booksTableBody');

            tableBody.innerHTML = '';

            books.forEach((book, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${book}</td>
                    <td class="tick-mark">
                        <input type="checkbox" class="book-checkbox" data-index="${index}">
                    </td>
                    <td>
                        <input type="text" class="book-note" placeholder="Catatan" style="width: 100%; padding: 5px; border: 1px solid #ddd; border-radius: 4px; font-size: 12px;">
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        function generatePreview() {
            const studentName = document.getElementById('studentName').value || '___________________';
            const className = document.getElementById('className').value || '___________________';
            const parentName = document.getElementById('parentName').value || '___________________';
            const selectedForm = document.getElementById('form').value;
            const books = textbooksData[selectedForm] || [];

            // Update preview student info
            document.getElementById('previewStudentName').textContent = studentName;
            document.getElementById('previewClassName').textContent = className;
            document.getElementById('previewParentName').textContent = parentName;

            // Count selected books
            const selectedBooks = document.querySelectorAll('.book-checkbox:checked').length;
            document.getElementById('previewBookCount').textContent = selectedBooks || books.length;

            // Update preview books table
            const previewTableBody = document.getElementById('previewBooksTable');
            previewTableBody.innerHTML = '';

            books.forEach((book, index) => {
                const checkbox = document.querySelector(`.book-checkbox[data-index="${index}"]`);
                const noteInput = document.querySelector(`.book-note[data-index="${index}"]`).parentElement.querySelector('.book-note');
                const isChecked = checkbox.checked;
                const note = noteInput.value || '';

                if (isChecked) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${book}</td>
                        <td style="text-align: center;">✓</td>
                        <td>${note}</td>
                    `;
                    previewTableBody.appendChild(row);
                }
            });

            // Set today's date
            const today = new Date();
            const dateStr = today.toLocaleDateString('ms-MY', { year: 'numeric', month: 'long', day: 'numeric' });
            document.getElementById('previewDate').textContent = `Tarikh: ${dateStr}`;

            // Show preview
            document.getElementById('printPreview').classList.add('active');

            // Scroll to preview
            setTimeout(() => {
                document.getElementById('printPreview').scrollIntoView({ behavior: 'smooth' });
            }, 100);

            // Auto print after delay
            setTimeout(() => {
                window.print();
            }, 500);
        }

        function resetForm() {
            document.getElementById('textbookForm').reset();
            document.getElementById('booksTableBody').innerHTML = '';
            document.getElementById('printPreview').classList.remove('active');
        }

        // Initialize on page load
        window.addEventListener('load', () => {
            updateBooksList();
        });

        // Fix for note input tracking
        document.addEventListener('input', (e) => {
            if (e.target.classList.contains('book-note')) {
                const row = e.target.closest('tr');
                const index = row.querySelector('.book-checkbox').dataset.index;
                // Note value is automatically saved in the input
            }
        });
    </script>
</body>
</html>
